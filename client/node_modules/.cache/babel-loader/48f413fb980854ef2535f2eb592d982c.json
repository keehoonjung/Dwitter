{"ast":null,"code":"export const tweetsPromiseThunk = (type, promiseCreator) => {\n  const [SUCCESS, ERROR] = [`${type}_SUCCESS`, `${type}_ERROR`];\n  return param => async dispatch => {\n    dispatch({\n      type\n    });\n\n    try {\n      const payload = await promiseCreator(param);\n      dispatch({\n        type: SUCCESS,\n        payload\n      });\n    } catch (e) {\n      dispatch({\n        type: ERROR,\n        payload: e,\n        error: true\n      });\n    }\n  };\n};\n\nconst defaultIdSelector = param => param;\n\nexport const tweetPromiseThunkById = (type, promiseCreator, idSelector = defaultIdSelector) => {\n  const [SUCCESS, ERROR] = [`${type}_SUCCESS`, `${type}_ERROR`];\n  return param => async dispatch => {\n    const id = idSelector(param);\n    console.log(typeof id);\n    console.log(id);\n    dispatch({\n      type,\n      meta: id\n    });\n\n    try {\n      const payload = await promiseCreator(param);\n      dispatch({\n        type: SUCCESS,\n        payload,\n        meta: id\n      });\n    } catch (e) {\n      console.log(e);\n      dispatch({\n        type: ERROR,\n        error: true,\n        payload: e,\n        meta: id\n      });\n    }\n  };\n};\nexport const tweetsReducerUtils = {\n  initial: (initialData = null) => ({\n    loading: false,\n    data: null,\n    error: null\n  }),\n  loading: (prevState = null) => ({\n    loading: true,\n    data: prevState,\n    error: null\n  }),\n  success: payload => ({\n    loading: false,\n    data: payload,\n    error: null\n  }),\n  error: error => ({\n    loading: false,\n    data: null,\n    error: error\n  })\n};\n\nconst handleAsyncActions = callback => {\n  return (type, key) => {\n    const [SUCCESS, ERROR] = [`${type}_SUCCESS`, `${type}_ERROR`];\n    return (state, action) => {\n      switch (action.type) {\n        case type:\n          const prevState = state[key] && state[key].data;\n          console.log(prevState);\n          return { ...state,\n            [key]: prevState ? tweetsReducerUtils.loading(prevState) : tweetsReducerUtils.loading()\n          };\n\n        case SUCCESS:\n          return callback(key, state, action);\n\n        case ERROR:\n          return { ...state,\n            [key]: tweetsReducerUtils.error(action.payload)\n          };\n\n        default:\n          return state;\n      }\n    };\n  };\n};\n\nconst getAsyncActionCallback = (key, state, action) => ({ ...state,\n  [key]: tweetsReducerUtils.success(action.payload)\n});\n\nconst postAsyncActionCallback = (key, state, action) => {\n  const result = action.payload;\n  return { ...state,\n    [key]: {\n      loading: false,\n      data: result ? [result, ...state[key].data] : state.posts.data,\n      error: null\n    }\n  };\n};\n\nconst deleteAsyncActionCallback = (key, state, action) => {\n  console.log(state);\n  return { ...state,\n    posts: { ...state.posts,\n      loading: false,\n      data: state.posts.data ? state.posts.data.filter(tweet => tweet.id !== action.meta) : null\n    }\n  };\n};\n\nconst updateAsyncActionCallback = (key, state, action) => ({ ...state,\n  posts: { ...state.posts,\n    data: state.posts.data ? state.posts.data.map(tweet => {\n      if (tweet.id !== action.meta) {\n        return tweet;\n      }\n\n      return action.payload;\n    }) : null\n  }\n});\n\nexport const handleAsyncGetTweetsActions = handleAsyncActions(getAsyncActionCallback);\nexport const handleAsyncPostTweetActions = handleAsyncActions(postAsyncActionCallback);\nexport const handleAsyncDeleteTweetActions = handleAsyncActions(deleteAsyncActionCallback);\nexport const handleAsyncUpdateTweetActions = handleAsyncActions(updateAsyncActionCallback);","map":{"version":3,"sources":["/Users/keehoonjung/projects/react/dwitter/client/src/util/tweets_async_utils.js"],"names":["tweetsPromiseThunk","type","promiseCreator","SUCCESS","ERROR","param","dispatch","payload","e","error","defaultIdSelector","tweetPromiseThunkById","idSelector","id","console","log","meta","tweetsReducerUtils","initial","initialData","loading","data","prevState","success","handleAsyncActions","callback","key","state","action","getAsyncActionCallback","postAsyncActionCallback","result","posts","deleteAsyncActionCallback","filter","tweet","updateAsyncActionCallback","map","handleAsyncGetTweetsActions","handleAsyncPostTweetActions","handleAsyncDeleteTweetActions","handleAsyncUpdateTweetActions"],"mappings":"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","sourcesContent":["export const tweetsPromiseThunk = (type, promiseCreator) => {\n  const [SUCCESS, ERROR] = [`${type}_SUCCESS`, `${type}_ERROR`];\n\n  return (param) => async (dispatch) => {\n    dispatch({ type });\n    try {\n      const payload = await promiseCreator(param);\n      dispatch({ type: SUCCESS, payload });\n    } catch (e) {\n      dispatch({ type: ERROR, payload: e, error: true });\n    }\n  };\n};\n\nconst defaultIdSelector = (param) => param;\nexport const tweetPromiseThunkById = (\n  type,\n  promiseCreator,\n  idSelector = defaultIdSelector\n) => {\n  const [SUCCESS, ERROR] = [`${type}_SUCCESS`, `${type}_ERROR`];\n\n  return (param) => async (dispatch) => {\n    const id = idSelector(param);\n    console.log(typeof id);\n    console.log(id);\n    dispatch({ type, meta: id });\n    try {\n      const payload = await promiseCreator(param);\n      dispatch({ type: SUCCESS, payload, meta: id });\n    } catch (e) {\n      console.log(e);\n      dispatch({ type: ERROR, error: true, payload: e, meta: id });\n    }\n  };\n};\n\nexport const tweetsReducerUtils = {\n  initial: (initialData = null) => ({\n    loading: false,\n    data: null,\n    error: null,\n  }),\n  loading: (prevState = null) => ({\n    loading: true,\n    data: prevState,\n    error: null,\n  }),\n  success: (payload) => ({\n    loading: false,\n    data: payload,\n    error: null,\n  }),\n  error: (error) => ({\n    loading: false,\n    data: null,\n    error: error,\n  }),\n};\n\nconst handleAsyncActions = (callback) => {\n  return (type, key) => {\n    const [SUCCESS, ERROR] = [`${type}_SUCCESS`, `${type}_ERROR`];\n    return (state, action) => {\n      switch (action.type) {\n        case type:\n          const prevState = state[key] && state[key].data;\n          console.log(prevState);\n          return {\n            ...state,\n            [key]: prevState\n              ? tweetsReducerUtils.loading(prevState)\n              : tweetsReducerUtils.loading(),\n          };\n        case SUCCESS:\n          return callback(key, state, action);\n        case ERROR:\n          return {\n            ...state,\n            [key]: tweetsReducerUtils.error(action.payload),\n          };\n        default:\n          return state;\n      }\n    };\n  };\n};\n\nconst getAsyncActionCallback = (key, state, action) => ({\n  ...state,\n  [key]: tweetsReducerUtils.success(action.payload),\n});\n\nconst postAsyncActionCallback = (key, state, action) => {\n  const result = action.payload;\n  return {\n    ...state,\n    [key]: {\n      loading: false,\n      data: result ? [result, ...state[key].data] : state.posts.data,\n      error: null,\n    },\n  };\n};\n\nconst deleteAsyncActionCallback = (key, state, action) => {\n  console.log(state);\n  return {\n    ...state,\n    posts: {\n      ...state.posts,\n      loading: false,\n      data: state.posts.data\n        ? state.posts.data.filter((tweet) => tweet.id !== action.meta)\n        : null,\n    },\n  };\n};\n\nconst updateAsyncActionCallback = (key, state, action) => ({\n  ...state,\n  posts: {\n    ...state.posts,\n    data: state.posts.data\n      ? state.posts.data.map((tweet) => {\n          if (tweet.id !== action.meta) {\n            return tweet;\n          }\n          return action.payload;\n        })\n      : null,\n  },\n});\n\nexport const handleAsyncGetTweetsActions = handleAsyncActions(\n  getAsyncActionCallback\n);\nexport const handleAsyncPostTweetActions = handleAsyncActions(\n  postAsyncActionCallback\n);\nexport const handleAsyncDeleteTweetActions = handleAsyncActions(\n  deleteAsyncActionCallback\n);\nexport const handleAsyncUpdateTweetActions = handleAsyncActions(\n  updateAsyncActionCallback\n);\n"]},"metadata":{},"sourceType":"module"}